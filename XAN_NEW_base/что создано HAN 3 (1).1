‚úÖ –ß–¢–û –°–û–ó–î–ê–ù–û:
üìÅ Backend (PHP):

–°–µ—Ä–≤–∏—Å—ã (7 –∫–ª–∞—Å—Å–æ–≤):

‚úÖ OverpaymentService.php - –ø–µ—Ä–µ–ø–ª–∞—Ç—ã
‚úÖ PaymentService.php - –ø–ª–∞—Ç–µ–∂–∏
‚úÖ SalesService.php - –ø—Ä–æ–¥–∞–∂–∏
‚úÖ StockService.php - —Å–∫–ª–∞–¥
‚úÖ ClientService.php - –∫–ª–∏–µ–Ω—Ç—ã
‚úÖ ProductService.php - —Ç–æ–≤–∞—Ä—ã
‚úÖ ReceiptService.php - –Ω–æ–º–µ—Ä–∞ —á–µ–∫–æ–≤


–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (10 —Ñ–∞–π–ª–æ–≤):

‚úÖ auth.php - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚úÖ clients.php - –∫–ª–∏–µ–Ω—Ç—ã
‚úÖ products.php - —Ç–æ–≤–∞—Ä—ã
‚úÖ production.php - –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
‚úÖ sales.php - –ø—Ä–æ–¥–∞–∂–∏
‚úÖ payments.php - –ø–ª–∞—Ç–µ–∂–∏
‚úÖ stock.php - —Å–∫–ª–∞–¥
‚úÖ writeoffs.php - —Å–ø–∏—Å–∞–Ω–∏—è
‚úÖ reports.php - –æ—Ç—á—ë—Ç—ã


–ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã (4 –∫–ª–∞—Å—Å–∞):

‚úÖ Database.php
‚úÖ Auth.php
‚úÖ Response.php
‚úÖ Middleware.php

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           –ö–û–ù–¢–†–û–õ–õ–ï–†–´                    ‚îÇ
‚îÇ  (—Ç–æ–ª—å–∫–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è)                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            –°–ï–†–í–ò–°–´                       ‚îÇ
‚îÇ  (–≤—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  SalesService ‚Üí ReceiptService          ‚îÇ
‚îÇ               ‚Üí StockService            ‚îÇ
‚îÇ               ‚Üí OverpaymentService      ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  PaymentService ‚Üí OverpaymentService    ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  ClientService ‚Üí OverpaymentService     ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  ProductService ‚Üí StockService          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          –ë–ê–ó–ê –î–ê–ù–ù–´–•                     ‚îÇ
‚îÇ  (v3.0, –≥–æ—Ç–æ–≤–∞ –∫ v3.1)                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
–ü–û–õ–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø HAN CRM API v3.1**

---

## üîê **–ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø**

### **POST** `/api/auth.php?action=login`
–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

**Request:**
```json
{
  "login": "admin",
  "password": "12345"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "user": {
      "id": 1,
      "name": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
      "login": "admin",
      "role": "admin"
    },
    "session_id": "abc123..."
  }
}
```

### **GET** `/api/auth.php?action=verify`
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏

### **POST** `/api/auth.php?action=logout`
–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

---

## üë• **–ö–õ–ò–ï–ù–¢–´** (`/api/clients.php`)

### **GET** `?action=index`
–°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –±–∞–ª–∞–Ω—Å–∞–º–∏
- `?page=1` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `?page_size=50` - —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `?search=–ò–≤–∞–Ω` - –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏/—Ç–µ–ª–µ—Ñ–æ–Ω—É

### **GET** `?action=show&id=1`
–î–µ—Ç–∞–ª–∏ –∫–ª–∏–µ–Ω—Ç–∞ + –∏—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–ø–ª–∞—Ç

### **POST** `?action=create`
–°–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
```json
{
  "name": "–û–û–û –†–æ–≥–∞ –∏ –ö–æ–ø—ã—Ç–∞",
  "phone": "+996 555 123 456",
  "address": "–≥. –ë–∏—à–∫–µ–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞ 1"
}
```

### **PUT** `?action=update&id=1`
–û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞

### **DELETE** `?action=delete&id=1`
–£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞

### **POST** `?action=withdraw-overpayment&id=1`
–í—ã–¥–∞—Ç—å –ø–µ—Ä–µ–ø–ª–∞—Ç—É –Ω–∞–ª–∏—á–Ω—ã–º–∏
```json
{
  "amount": 100.50,
  "note": "–í—ã–¥–∞–Ω–æ –ø–æ –ø—Ä–æ—Å—å–±–µ –∫–ª–∏–µ–Ω—Ç–∞"
}
```

### **GET** `?action=debtors`
–°–ø–∏—Å–æ–∫ –¥–æ–ª–∂–Ω–∏–∫–æ–≤

### **GET** `?action=overpayments`
–ö–ª–∏–µ–Ω—Ç—ã —Å –ø–µ—Ä–µ–ø–ª–∞—Ç–∞–º–∏

### **POST** `?action=recalculate-balance&id=1`
–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –±–∞–ª–∞–Ω—Å –∫–ª–∏–µ–Ω—Ç–∞

---

## üì¶ **–¢–û–í–ê–†–´** (`/api/products.php`)

### **GET** `?action=index`
–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å –æ—Å—Ç–∞—Ç–∫–∞–º–∏
- `?active_only=true` - —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
- `?search=—Å–µ–º–µ—á–∫–∏` - –ø–æ–∏—Å–∫

### **GET** `?action=show&id=1`
–î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞ + –∏—Å—Ç–æ—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏–π

### **POST** `?action=create`
–°–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä
```json
{
  "name": "–•–ê–ù —Å–µ–º–µ—á–∫–∏ —Å–æ–ª–µ–Ω—ã–µ 2–∫–≥",
  "price": 191.00,
  "is_active": 1
}
```

### **PUT** `?action=update&id=1`
–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä

### **PUT** `?action=update-prices`
–ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω
```json
[
  {"id": 1, "price": 195.00},
  {"id": 2, "price": 525.00}
]
```

### **DELETE** `?action=delete&id=1`
–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä

### **GET** `?action=stock`
–û—Å—Ç–∞—Ç–∫–∏ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤

### **POST** `?action=adjust-stock&id=1`
–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –æ—Å—Ç–∞—Ç–∫–∞
```json
{
  "new_quantity": 150,
  "reason": "–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è"
}
```

### **POST** `?action=writeoff`
–°–ø–∏—Å–∞—Ç—å —Ç–æ–≤–∞—Ä
```json
{
  "product_id": 1,
  "quantity": 10,
  "type": "defect",
  "reason": "–ë—Ä–∞–∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞"
}
```

### **GET** `?action=writeoffs`
–ñ—É—Ä–Ω–∞–ª —Å–ø–∏—Å–∞–Ω–∏–π
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`
- `?product_id=1`
- `?type=defect`

---

## üè≠ **–ü–†–û–ò–ó–í–û–î–°–¢–í–û** (`/api/production.php`)

### **GET** `?action=index`
–ñ—É—Ä–Ω–∞–ª –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
- `?date_from=2024-01-01`
- `?shift=day` / `night`
- `?product_id=1`

### **POST** `?action=create`
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
```json
{
  "product_id": 1,
  "quantity": 500,
  "shift": "day",
  "note": "–ü–∞—Ä—Ç–∏—è ‚Ññ123"
}
```

### **DELETE** `?action=delete&id=1`
–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞

### **GET** `?action=stats`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`

---

## üõí **–ü–†–û–î–ê–ñ–ò** (`/api/sales.php`)

### **GET** `?action=index`
–°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥–∞–∂
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`
- `?client_id=1`
- `?receipt_number=000123`
- `?has_debt=true`

### **GET** `?action=show&id=1`
–î–µ—Ç–∞–ª–∏ –ø—Ä–æ–¥–∞–∂–∏

### **POST** `?action=create`
–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥–∞–∂—É
```json
{
  "client_id": 1,
  "items": [
    {
      "product_id": 1,
      "quantity": 10,
      "price": 191.00
    },
    {
      "product_id": 2,
      "quantity": 5,
      "price": 520.00
    }
  ],
  "paid": 3000.00
}
```

**–õ–æ–≥–∏–∫–∞:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å–æ —Å–∫–ª–∞–¥–∞
- –°–æ–∑–¥–∞—ë—Ç –ø–µ—Ä–≤–∏—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂
- –ï—Å–ª–∏ `paid > total` ‚Üí —Å–æ–∑–¥–∞—ë—Ç –ø–µ—Ä–µ–ø–ª–∞—Ç—É

### **DELETE** `?action=delete&id=1`
–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–¥–∞–∂—É

**–õ–æ–≥–∏–∫–∞:**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –Ω–∞ —Å–∫–ª–∞–¥
- –û—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–ø–ª–∞—Ç—É
- Soft delete –ø–ª–∞—Ç–µ–∂–µ–π

### **GET** `?action=stats`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`

---

## üí∞ **–ü–õ–ê–¢–ï–ñ–ò** (`/api/payments.php`)

### **GET** `?action=index&sale_id=1`
–°–ø–∏—Å–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ –ø—Ä–æ–¥–∞–∂–µ

### **POST** `?action=create`
–î–æ–±–∞–≤–∏—Ç—å –ø–ª–∞—Ç—ë–∂
```json
{
  "sale_id": 1,
  "amount": 1000.00,
  "payment_method": "cash",
  "note": "–ü–æ–≥–∞—à–µ–Ω–∏–µ –¥–æ–ª–≥–∞"
}
```

**–õ–æ–≥–∏–∫–∞:**
- –û–±–Ω–æ–≤–ª—è–µ—Ç `paid`, `debt`, `new_overpayment` –≤ –ø—Ä–æ–¥–∞–∂–µ
- –ï—Å–ª–∏ –ø–æ—è–≤–∏–ª–∞—Å—å –ø–µ—Ä–µ–ø–ª–∞—Ç–∞ ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç—É

### **DELETE** `?action=delete&id=1`
–£–¥–∞–ª–∏—Ç—å –ø–ª–∞—Ç—ë–∂

**–õ–æ–≥–∏–∫–∞:**
- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç `paid`, `debt`
- –û—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–ø–ª–∞—Ç—É (–µ—Å–ª–∏ –±—ã–ª–∞)

### **GET** `?action=stats`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`

---

## üìä **–°–ö–õ–ê–î** (`/api/stock.php`)

### **GET** `?action=index`
–í—Å–µ –æ—Å—Ç–∞—Ç–∫–∏ + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### **GET** `?action=show&id=1`
–û—Å—Ç–∞—Ç–æ–∫ —Ç–æ–≤–∞—Ä–∞ + –∏—Å—Ç–æ—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏–π

### **POST** `?action=adjust&id=1`
–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –æ—Å—Ç–∞—Ç–∫–∞
```json
{
  "new_quantity": 150,
  "reason": "–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è 2024"
}
```

### **GET** `?action=movements`
–ò—Å—Ç–æ—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏–π
- `?product_id=1`
- `?limit=100`

### **GET** `?action=movement-stats`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–≤–∏–∂–µ–Ω–∏–π
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`

### **GET** `?action=low-stock`
–¢–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º –æ—Å—Ç–∞—Ç–∫–æ–º
- `?threshold=10`

### **GET** `?action=dormant`
–¢–æ–≤–∞—Ä—ã –±–µ–∑ –¥–≤–∏–∂–µ–Ω–∏—è
- `?days=30`

### **GET** `?action=reconciliation`
–°–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏)

### **POST** `?action=mass-adjust`
–ú–∞—Å—Å–æ–≤–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ admin)
```json
{
  "adjustments": [
    {"product_id": 1, "new_quantity": 150, "reason": "–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è"},
    {"product_id": 2, "new_quantity": 200, "reason": "–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è"}
  ]
}
```

---

## üóëÔ∏è **–°–ü–ò–°–ê–ù–ò–Ø** (`/api/writeoffs.php`)

### **GET** `?action=index`
–ñ—É—Ä–Ω–∞–ª —Å–ø–∏—Å–∞–Ω–∏–π
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`
- `?product_id=1`
- `?type=defect` / `expired` / `damage` / `other`

### **GET** `?action=show&id=1`
–î–µ—Ç–∞–ª–∏ —Å–ø–∏—Å–∞–Ω–∏—è

### **POST** `?action=create`
–°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–∞–Ω–∏–µ
```json
{
  "product_id": 1,
  "quantity": 10,
  "type": "defect",
  "reason": "–ë—Ä–∞–∫ —É–ø–∞–∫–æ–≤–∫–∏"
}
```

### **DELETE** `?action=delete&id=1`
–û—Ç–º–µ–Ω–∏—Ç—å —Å–ø–∏—Å–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ admin)

### **GET** `?action=stats`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–ø–∏—Å–∞–Ω–∏–π
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`

### **GET** `?action=export`
–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`

### **GET** `?action=top-products`
–¢–æ–ø —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å–ø–∏—Å–∞–Ω–∏—è–º
- `?limit=10`
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`

---

## üìà **–û–¢–ß–Å–¢–´** (`/api/reports.php`)

### **GET** `?action=summary`
–°–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç
- –ü—Ä–æ–¥–∞–∂–∏, –ø–ª–∞—Ç–µ–∂–∏, –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ, —Å–ø–∏—Å–∞–Ω–∏—è
- –û—Å—Ç–∞—Ç–∫–∏, –¥–æ–ª–≥–∏, –ø–µ—Ä–µ–ø–ª–∞—Ç—ã

### **GET** `?action=debtors`
–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –¥–æ–ª–∂–Ω–∏–∫–∞–º

### **GET** `?action=overpayments`
–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –ø–µ—Ä–µ–ø–ª–∞—Ç–∞–º

### **GET** `?action=stock`
–û—Ç—á—ë—Ç –ø–æ —Å–∫–ª–∞–¥—É (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º)

### **GET** `?action=sales`
–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
- –ü–æ –¥–Ω—è–º
- –ü–æ –∫–ª–∏–µ–Ω—Ç–∞–º
- –ü–æ —Ç–æ–≤–∞—Ä–∞–º

### **GET** `?action=payments`
–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º
- –ü–æ –¥–Ω—è–º
- –ü–æ –º–µ—Ç–æ–¥–∞–º –æ–ø–ª–∞—Ç—ã
- –ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

### **GET** `?action=export`
–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞ –≤ CSV
- `?type=sales` / `debtors` / `stock`
- `?date_from=2024-01-01`
- `?date_to=2024-12-31`

---

## üîÑ **–¢–ò–ü–ò–ß–ù–´–ï –°–¶–ï–ù–ê–†–ò–ò**

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–æ–¥–∞–∂–∞ —Å –ø–µ—Ä–µ–ø–ª–∞—Ç–æ–π**

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥–∞–∂—É
POST /api/sales.php?action=create
{
  "client_id": 1,
  "items": [{"product_id": 1, "quantity": 10, "price": 191}],
  "paid": 2000
}

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# - total = 1910
# - paid = 2000
# - debt = 0
# - new_overpayment = 90
# - –¢–æ–≤–∞—Ä —Å–ø–∏—Å–∞–Ω —Å–æ —Å–∫–ª–∞–¥–∞
# - –ü–µ—Ä–µ–ø–ª–∞—Ç–∞ 90 —Å–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç—É
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–≥–∞—à–µ–Ω–∏–µ –¥–æ–ª–≥–∞**

```bash
# 1. –ü—Ä–æ–¥–∞–∂–∞ —Å –¥–æ–ª–≥–æ–º
POST /api/sales.php?action=create
{
  "client_id": 1,
  "items": [{"product_id": 1, "quantity": 10, "price": 191}],
  "paid": 1000
}

# –†–µ–∑—É–ª—å—Ç–∞—Ç: debt = 910

# 2. –ü–æ–≥–∞—à–µ–Ω–∏–µ –¥–æ–ª–≥–∞
POST /api/payments.php?action=create
{
  "sale_id": 1,
  "amount": 500,
  "payment_method": "cash"
}

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# - paid = 1500
# - debt = 410
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏**

```bash
DELETE /api/sales.php?action=delete&id=1

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# - –¢–æ–≤–∞—Ä—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –Ω–∞ —Å–∫–ª–∞–¥
# - –ü–µ—Ä–µ–ø–ª–∞—Ç–∞ –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å
# - –ü–ª–∞—Ç–µ–∂–∏ —É–¥–∞–ª–µ–Ω—ã (soft delete)
# - –ü—Ä–æ–¥–∞–∂–∞ —É–¥–∞–ª–µ–Ω–∞ (soft delete)
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 4: –í—ã–¥–∞—á–∞ –ø–µ—Ä–µ–ø–ª–∞—Ç—ã**

```bash
POST /api/clients.php?action=withdraw-overpayment&id=1
{
  "amount": 50,
  "note": "–í—ã–¥–∞–Ω–æ –Ω–∞–ª–∏—á–Ω—ã–º–∏"
}

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# - –ë–∞–ª–∞–Ω—Å —É–º–µ–Ω—å—à–µ–Ω –Ω–∞ 50
# - –ó–∞–ø–∏—Å—å –≤ client_overpayments (type='withdrawn')
```

---

## ‚ö†Ô∏è **–ö–û–î–´ –û–®–ò–ë–û–ö**

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| 200 | –£—Å–ø–µ—à–Ω–æ |
| 201 | –°–æ–∑–¥–∞–Ω–æ |
| 400 | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| 401 | –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω |
| 403 | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ |
| 404 | –ù–µ –Ω–∞–π–¥–µ–Ω–æ |
| 405 | –ú–µ—Ç–æ–¥ –Ω–µ —Ä–∞–∑—Ä–µ—à—ë–Ω |
| 422 | –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

---

## üîê **–†–û–õ–ò –ò –ü–†–ê–í–ê**

| –†–æ–ª—å | –ü—Ä–∞–≤–∞ |
|------|-------|
| **admin** | –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ + —É–¥–∞–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π/–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ |
| **manager** | CRUD –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø—Ä–æ–¥–∞–∂–∏, –ø–ª–∞—Ç–µ–∂–∏, –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ |
| **cashier** | –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂, –ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö |

---

üéØ **API –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!**